---
title: "lending_Club"
author: "Huiting Sheng, Hua Zou, Lixin Wang"
date: "9/9/2020"
output: html_document
---

```{r import library}
packages=c("caret","ggplot2", "tidyverse", "dplyr", "corrplot")
## Now load or install&load all
package.check <- lapply(packages,FUN = function(x) {
    if (!require(x, character.only = TRUE)) {
      install.packages(x, dependencies = TRUE)
      library(x, character.only = TRUE)
    }
  }
)
```

```{r}
data=read.csv("LoanStats3a.csv", header=T)
data=as_tibble(data)
data
```
The original data dimension is `r dim(data)`. 

```{r split the data into X and Y}
X=select(data,-loan_status)
Y=select(data,loan_status) %>%unlist()
```

#### get data structure
```{r data structure}
str(data)
sapply(data,function(x) length(unique(x)))
```
quanlitive: term
numeric
suspicious
```{r clean data }
## get columns that doesn't have any info
emptycols=c()
for (i in 1:ncol(data)){
  if (all(is.na(data[,i]))) {
    emptycols=c(emptycols,colnames(data[,i]))
  }
}
emptycols
## remove the empty columns
df <- data %>%select(-emptycols)

str(df)


ggplot_missing = function(x) {
  if (!require(reshape2)) warning("you need to install reshape2")
  require(reshape2)
  x %>% is.na %>% melt
}


badaccount=df %>% filter((!loan_status %in% c("Fully Paid", "Current"))) %>% select(-c(pymnt_plan,url,initial_list_status,policy_code, application_type))

table(df$pub_rec)
filter(badcustom, loan_status=="Does not meet the credit policy. Status:Charged Off")$pymnt_plan
table(badcustom$next_pymnt_d)
```
pymnt_plan=="y" only one record, remove url, initial_list_status,policy_code, application_type
most charge off account out_prncp is 0
```{r}
state=as.table(table(df$addr_state))
ggplot(state) + geom_histogram()
```

